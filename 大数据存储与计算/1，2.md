### 加载数据

```load data local inpath '/d/a.txt' into table school.student```

### 创建表

#### 结构体

```sql
create table school.student(id int ,info struct<name:string,age:int)	
row format delimited  
fields terminated by ','  --字段以','分割
collection items terminated by ':'; --集合项以':' 分割
```

##  ![image-20251130203518639](C:\Users\赵兴理\AppData\Roaming\Typora\typora-user-images\image-20251130203518639.png)                 

#### 相关操作

```select info.name from school.student```

 ![image-20251130203648443](C:\Users\赵兴理\AppData\Roaming\Typora\typora-user-images\image-20251130203648443.png)





#### map

```sql 
create table student3(id int ,perf map<string,int>)
row format delimited
fields terminated by '\t'
collection items terminated by ',' --map属性可以有多个键值对，这些键值对用','分开，他们的键不能相同 
map keys terminated by ':' ; --map的key和value用':'分开···
```

 ![image-20251130204031773](C:\Users\赵兴理\AppData\Roaming\Typora\typora-user-images\image-20251130204031773.png)

#### 相关操作

```select perf['team'] from student3```

 ![image-20251130204416891](C:\Users\赵兴理\AppData\Roaming\Typora\typora-user-images\image-20251130204416891.png)

#### array

```sql
create table student4(name string , emp_id_list array<int>)
row format delimited
fields terminated by ','
collection items terminated by ':';
```

### 修改字段名

需要全部修改

字段名	数据类型	更改字段名称	转换为数据类型
id	int	emp_id	int
name	string	emp_name	string
department	string	department	string
salary	float	salary	double

```sql
alter table employee replace columns(emp_id int,emp_name string
    ,department string,salary double);
```

### 增加字段

```sql
alter table employee add columns(hiredate date);
```

####  删除字段

```sql
ALTER TABLE 表名 DROP COLUMN 列名1, DROP COLUMN 列名2;
```



### 数据库操作

```sql
create database if not exists test1
comment 'new database'
location '/hive/test1'
with dbproperties('creator'='John','date'='2019-02-25');
alter database test1 set dbproperties('creator'='Marry'); --修改表附加信息
drop database test1;
```

```
create database if not exists test2;
create table if not exists test2.student(
    Sno int comment 'student sno',
    name string comment 'student name',
    age int comment 'student age',
    sex string comment 'student sex',
    score struct<Chinese:float,Math:float,English:float> comment 'student score'
);
create table if not exists test2.student_info like test2.student;
drop table test2.student;
```

#### 计算不同工作年限以及其平均工资并且过滤出平均工资大于10000的

```sql
select avg(salary) as sl,workingExp 
from table1
group by workingExp
having sl>10000;
```

#### 添加、修改、删除静态分区

```sql
alter table test4.student add partition(stu_year='2018',subject='Chinese')
partition(stu_year='2018',subject='Math');
alter table test4.student partition(stu_year='2018',subject='Math') rename to
partition(stu_year='2018',subject='English');
alter table test4.student drop partition(stu_year='2018',subject='Chinese');
```

#### 2013年7月25日每种股票总共被客户买入了多少元。

```sql
SELECT
    securityid,
    SUM(CAST(bidpx1 AS FLOAT) * bidsize1)
FROM total
WHERE tradedate = '20130725'
GROUP BY securityid;
```

#### 从其他表中追加/覆盖信息

```sq;
insert into table student2
select * from student where sex='male';
insert overwrite table student3
select * from student where sex='female';
```

#### 将表中的信息写入文件

```
insert overwrite local directory '/home/test4'
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' --可选
select * from student limit 2;
insert into local directory '/home/test4_1'
select * from student where sex='male';
```







